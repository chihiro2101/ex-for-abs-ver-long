Cryptographically secure pseudorandom number generator

requirements . the requirements of an ordinary prng are also satisfied by a cryptographically secure prng , but the reverse is not true . csprng requirements fall into two groups : first , that they pass statistical randomness tests ; and secondly , that they hold up well under serious attack , even when part of their initial or running state becomes available to an attacker . every csprng should satisfy the next-bit test . that is , given the first k bits of a random sequence , there is no polynomial-time algorithm that can predict the ( k +1 ) th bit with probability of success non-negligibly better than 50 % . andrew yao proved in 1982 that a generator passing the next-bit test will pass all other polynomial-time statistical tests for randomness . andrew chi-chih yao . theory and applications of trapdoor functions . in proceedings of the 23rd ieee symposium on foundations of computer science , 1982 . every csprng should withstand '' state compromise extensions '' . in the event that part or all of its state has been revealed ( or guessed correctly ) , it should be impossible to reconstruct the stream of random numbers prior to the revelation . additionally , if there is an entropy input while running , it should be infeasible to use knowledge of the input 's state to predict future conditions of the csprng state . : : example : if the csprng under consideration produces output by computing bits of π in sequence , starting from some unknown point in the binary expansion , it may well satisfy the next-bit test and thus be statistically random , as π appears to be a random sequence . ( this would be guaranteed if π is a normal number , for example . ) however , this algorithm is not cryptographically secure ; an attacker who determines which bit of pi ( i.e . the state of the algorithm ) is currently in use will be able to calculate all preceding bits as well . most prngs are not suitable for use as csprngs and will fail on both counts . first , while most prngs outputs appear random to assorted statistical tests , they do not resist determined reverse engineering . specialized statistical tests may be found specially tuned to such a prng that shows the random numbers not to be truly random . second , for most prngs , when their state has been revealed , all past random numbers can be retrodicted , allowing an attacker to read all past messages , as well as future ones . csprngs are designed explicitly to resist this type of cryptanalysis . definitions . in the asymptotic setting , a family of deterministic polynomial time computable functions g_k\colon\ : obviously , the technique is easily generalized to any block cipher ; aes has been suggested . . standards . several csprngs have been standardized . for example , fips 186-4 nist sp 800-90a : : this withdrawn standard has four prngs . two of them are uncontroversial and proven : csprngs named hash_drbg and hmac_drbg . : the third prng in this standard , ctr drbg , is based on a block cipher running in counter mode . it has an uncontroversial design but has been proven to be weaker in terms of distinguishing attack , than the security level of the underlying block cipher when the number of bits output from this prng is greater than two to the power of the underlying block cipher 's block size in bits . : when the maximum number of bits output from this prng is equal to the 2 blocksize , the resulting output delivers the mathematically expected security level that the key size would be expected to generate , but the output is shown to not be indistinguishable from a true random number generator . when the maximum number of bits output from this prng is less than it , the expected security level is delivered and the output appears to be indistinguishable from a true random number generator . : it is noted in the next revision that claimed security strength for ctr_drbg depends on limiting the total number of generate requests and the bits provided per generate request . : the fourth and final prng in this standard is named dual_ec_drbg . it has been shown to not be cryptographically secure and is believed to have a kleptography nsa backdoor . nist sp 800-90a rev.1 : this is essentially nist sp 800-90a with dual_ec_drbg removed , and is the withdrawn standard 's replacement . ansi x9.17-1985 appendix c ansi x9.31-1998 appendix a.2.4 ansi x9.62-1998 annex a.4 , obsoleted by ansi x9.62-2005 , annex d ( hmac_drbg ) a good reference is maintained by nist . there are also standards for statistical testing of new csprng designs : a statistical test suite for random and pseudorandom number generators , nist special publication 800-22 . nsa kleptographic backdoor in the dual_ec_drbg prng . the guardian and the new york times have reported in 2013 that the national security agency ( nsa ) inserted a backdoor into a pseudorandom number generator ( prng ) of nist sp 800-90a which allows the nsa to readily decrypt material that was encrypted with the aid of dual_ec_drbg . both papers report that , as independent security experts long suspected , the nsa has been introducing weaknesses into csprng standard 800-90 ; this being confirmed for the first time by one of the top secret documents leaked to the guardian by edward snowden . the nsa worked covertly to get its own version of the nist draft security standard approved for worldwide use in 2006 . the leaked document states that '' eventually , nsa became the sole editor . '' in spite of the known potential for a kleptography backdoor and other known significant deficiencies with dual_ec_drbg , several companies such as rsa security continued using dual_ec_drbg until the backdoor was confirmed in 2013 . rsa security received a 10 million payment from the nsa to do so . . security flaws . duhk attack . on october 23 , 2017 , shaanan cohney , matthew green , and nadia heninger , cryptographers at the university of pennsylvania and johns hopkins university released details of the duhk ( do n't use hard-coded keys ) attack on wpa2 where hardware vendors use a hardcoded seed key for the ansi x9.31 rng algorithm in conjunction with the usage of the ansi x9.31 random number generator , '' an attacker can brute-force encrypted data to discover the rest of the encryption parameters and deduce the master encryption key used to encrypt web sessions or virtual private network ( vpn ) connections . '' . japanese purple cipher machine . during world war ii , japan used a cipher machine used for diplomatic communications ; the united states was able to type b cipher machine purple , mostly because the '' key values '' used were insufficiently random . references . external links . , randomness requirements for security java '' entropy pool '' for cryptographically secure unpredictable random numbers . java standard class providing a cryptographically strong pseudo-random number generator ( prng ) . cryptographically secure random number on windows without using cryptoapi conjectured security of the ansi-nist elliptic curve rng , daniel r . l . brown , iacr eprint 2006/117 . a security analysis of the nist sp 800-90 elliptic curve random number generator , daniel r . l . brown and kristian gjosteen , iacr eprint 2007/048 . to appear in crypto 2007 . cryptanalysis of the dual elliptic curve pseudorandom generator , berry schoenmakers and andrey sidorenko , iacr eprint 2006/190 . efficient pseudorandom generators based on the ddh assumption , reza rezaeian farashahi and berry schoenmakers and andrey sidorenko , iacr eprint 2006/321 . analysis of the linux random number generator , zvi gutterman and benny pinkas and tzachy reinman . nist statistical test suite documentation and software download .