Differentiated services

background . modern data networks carry many different types of services , including voice , video , streaming music , web pages and email . many of the proposed qos mechanisms that allowed these services to co-exist were both complex and failed to scale to meet the demands of the public internet . in december 1998 , the ietf published - definition of the differentiated services field ( ds field ) in the ipv4 and ipv6 headers , which replaced the ipv4 tos field with the ds field . in the ds field , a range of eight values ( class selectors ) is used for backward compatibility with the ip precedence specification in the former tos field . today , diffserv has largely supplanted tos and other layer 3 qos mechanisms , such as integrated services ( intserv ) , as the primary architecture routers use to provide qos . traffic management mechanisms . diffserv is a coarse-grained , class-based mechanism for traffic management . in contrast , intserv is a fine-grained , flow-based mechanism . diffserv relies on a mechanism to classify and mark packets as belonging to a specific class . diffserv-aware routers implement per-hop behaviors ( phbs ) , which define the packet-forwarding properties associated with a class of traffic . different phbs may be defined to offer , for example , low-loss or low-latency service . rather than differentiating network traffic based on the requirements of an individual flow , diffserv operates on the principle of traffic classification , placing each data packet into one of a limited number of traffic classes . each router on the network is then configured to differentiate traffic based on its class . each traffic class can be managed differently , ensuring preferential treatment for higher-priority traffic on the network . the premise of diffserv is that complicated functions such as packet classification and policing can be carried out at the edge of the network by edge routers . since no classification and policing is required in the core router , functionality there can then be kept simple . core routers simply apply phb treatment to packets based on their markings . phb treatment is achieved by core routers using a combination of scheduling policy and queue management policy . a group of routers that implement common , administratively defined diffserv policies are referred to as a diffserv domain . while diffserv does recommend a standardized set of traffic classes , the diffserv architecture does not incorporate predetermined judgments of what types of traffic should be given priority treatment . diffserv simply provides a framework to allow classification and differentiated treatment . the standard traffic classes ( discussed below ) serve to simplify interoperability between different networks and different vendors ' equipment . classification and marking . network traffic entering a diffserv domain is subjected to classification and conditioning . a traffic classifier may inspect many different parameters in incoming packets , such as source address , destination address or traffic type and assign individual packets to a specific traffic class . traffic classifiers may honor any diffserv markings in received packets or may elect to ignore or override those markings . for tight control over volumes and type of traffic in a given class , a network operator may choose not to honor markings at the ingress to the diffserv domain . traffic in each class may be further conditioned by subjecting the traffic to rate limiting , traffic policers or shapers . section 3 the per-hop behavior is determined by the ds field in the ip header . the ds field contains the 6-bit dscp value . explicit congestion notification ( ecn ) occupies the least-significant 2 bits of the ipv4 tos field and ipv6 traffic class ( tc ) field . filtering dscp in theory , a network could have up to 64 different traffic classes using the 64 available dscp values . the diffserv rfcs recommend , but do not require , certain encodings . this gives a network operator great flexibility in defining traffic classes . in practice , however , most networks use the following commonly defined per-hop behaviors : default forwarding ( df ) phb — which is typically best-effort traffic expedited forwarding ( ef ) phb — dedicated to low-loss , low-latency traffic assured forwarding ( af ) phb — gives assurance of delivery under prescribed conditions class selector phbs — which maintain backward compatibility with the ip precedence field . default forwarding . a default forwarding ( df ) phb is the only required behavior . essentially , any traffic that does not meet the requirements of any of the other defined classes uses df . typically , df has best-effort forwarding characteristics . the recommended dscp for df is 0 . . expedited forwarding . the ietf defines expedited forwarding ( ef ) behavior in . the ef phb has the characteristics of low delay , low loss and low jitter . these characteristics are suitable for voice , video and other realtime services . ef traffic is often given priority queue above all other traffic classes . because an overload of ef traffic will cause queuing delays and affect the jitter and delay tolerances within the class , admission control , traffic policing and other mechanisms may be applied to ef traffic . the recommended dscp for ef is 101110 b ( 46 or 2e h ) . voice admit . the ietf defines voice admit behavior in . the voice admit phb has identical characteristics to the expedited forwarding phb . however , voice admit traffic is also admitted by the network using a call admission control ( cac ) procedure . the recommended dscp for voice admit is 101100 b ( 44 or 2c h ) . assured forwarding . the ietf defines the assured forwarding ( af ) behavior in and . assured forwarding allows the operator to provide assurance of delivery as long as the traffic does not exceed some subscribed rate . traffic that exceeds the subscription rate faces a higher probability of being dropped if congestion occurs . the af behavior group defines four separate af classes with all traffic within one class having the same priority . within each class , packets are given a drop precedence ( high , medium or low , where higher precedence means more dropping ) . the combination of classes and drop precedence yields twelve separate dscp encodings from af11 through af43 ( see table ) . design considerations . under diffserv , all the policing and classifying are done at the boundaries between diffserv domains . this means that in the core of the internet , routers are unhindered by the complexities of collecting payment or enforcing agreements . that is , in contrast to intserv , diffserv requires no advance setup , no reservation , and no time-consuming end-to-end negotiation for each flow . the details of how individual routers deal with the ds field are configuration specific , therefore it is difficult to predict end-to-end behavior . this is complicated further if a packet crosses two or more diffserv domains before reaching its destination . from a commercial viewpoint , this means that it is impossible to sell different classes of end-to-end connectivity to end users , as one provider 's gold packet may be another 's bronze . diffserv or any other ip based qos marking does not ensure the quality of the service or a specified service-level agreement ( sla ) . by marking the packets , the sender indicates that it wants the packets to be treated as a specific service , but there is no guarantee this happens . it is up to all the service providers and their routers in the path to ensure that their policies will take care of the packets in an appropriate fashion . bandwidth broker . a bandwidth broker in the framework of diffserv is an agent that has some knowledge of an organization 's priorities and policies and allocates bandwidth with respect to those policies . in order to achieve an end-to-end allocation of resources across separate domains , the bandwidth broker managing a domain will have to communicate with its adjacent peers , which allows end-to-end services to be constructed out of purely bilateral agreements . diffserv rfcs . — definition of the differentiated services field ( ds field ) in the ipv4 and ipv6 headers . — an architecture for differentiated services . — assured forwarding phb group . — differentiated services and tunnels . — definition of differentiated services per-domain behaviors and rules for their specification . — per hop behavior identification codes . ( obsoletes . ) — an expedited forwarding phb . ( obsoletes . ) — supplemental information for the new definition of the ef phb ( expedited forwarding per-hop behavior ) . — new terminology and clarifications for diffserv . ( updates , and . ) — configuration guidelines for diffserv service classes . — a differentiated services code point ( dscp ) for capacity-admitted traffic . ( updates and . ) — a lower-effort per-hop behavior ( le phb ) for differentiated services . ( updates and , obsoletes . ) . diffserv management rfcs . — management information base for the differentiated services architecture . — an informal management model for differentiated services routers . — differentiated services quality of service policy information base . see also . class of service teletraffic engineering . references . further reading . . external links . ietf diffserv working group page cisco whitepaper — diffserv-the scalable end-to-end quality of service model acm sigcomm'09 paper- modeling and understanding end-to-end class of service policies in operational networks : proposes a practical model for extracting diffserv policies cisco : implementing quality of service policies with dscp