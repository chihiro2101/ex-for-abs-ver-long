Playfair cipher

history . image : lyon playfair.jpg thumbnail lord playfair , who heavily promoted its use . the playfair cipher was the first cipher to encrypt pairs of letters in cryptologic history . wheatstone invented the cipher for secrecy in telegraphy , but it carries the name of his friend lord playfair , first baron playfair of st . andrews , who promoted its use . the first recorded description of the playfair cipher was in a document signed by wheatstone on 26 march 1854 . it was initially rejected by the british foreign office when it was developed because of its perceived complexity . wheatstone offered to demonstrate that three out of four boys in a nearby school could learn to use it in 15 minutes , but the under secretary of the foreign office responded , '' that is very possible , but you could never teach it to attachés . '' it was however later used for tactical purposes by british forces in the second boer war and in world war i and for the same purpose by the uk and australians during world war ii . this was because playfair is reasonably fast to use and requires no special equipment - just a pencil and some paper . a typical scenario for playfair use was to protect important but non-critical secrets during actual combat e.g . the fact that an artillery barrage of smoke shells would commence within 30 minutes to cover soldiers ' advance towards the next objective . by the time enemy cryptanalysts could decode such messages hours later , such information would be useless to them because it was no longer relevant . during world war ii , the government of new zealand used it for communication among new zealand , the chatham islands , and the coastwatchers in the pacific islands . '' a history of communications security in new zealand by eric mogon '' , chapter 8 coastwatchers established by royal australian navy intelligence also used this cipher . . superseded . playfair is no longer used by military forces because of the advent of digital encryption devices . this cipher is now regarded as insecure for any purpose , because modern computers could easily break it within microseconds . the first published solution of the playfair cipher was described in a 19-page pamphlet by lieutenant joseph o . mauborgne , published in 1914 . mauborgne , joseph oswald , an advanced problem in cryptography and its solution ( fort leavenwoth , kansas : army service schools press , 1914 ) . . description . the playfair cipher uses a 5 by 5 table containing a key ( cryptography ) . memorization of the keyword and 4 simple rules was all that was required to create the 5 by 5 table and use the cipher . to generate the key table , one would first fill in the spaces in the table ( a modified polybius square ) with the letters of the keyword ( dropping any duplicate letters ) , then fill the remaining spaces with the rest of the letters of the alphabet in order ( usually omitting '' j '' or '' q '' to reduce the alphabet to fit ; other versions put both '' i '' and '' j '' in the same space ) . the key can be written in the top rows of the table , from left to right , or in some other pattern , such as a spiral beginning in the upper-left-hand corner and ending in the center . the keyword together with the conventions for filling in the 5 by 5 table constitute the cipher key . to encrypt a message , one would break the message into digrams ( groups of 2 letters ) such that , for example , '' helloworld '' becomes '' he ll ow or ld '' . these digrams will be substituted using the key table . since encryption requires pairs of letters , messages with an odd number of characters usually append an uncommon letter , such as '' x '' , to complete the final digram . the two letters of the digram are considered opposite corners of a rectangle in the key table . to perform the substitution , apply the following 4 rules , in order , to each pair of letters in the plaintext : if both letters are the same ( or only one letter is left ) , add an '' x '' after the first letter . encrypt the new pair and continue . some variants of playfair use '' q '' instead of '' x '' , but any letter , itself uncommon as a repeated pair , will do . if the letters appear on the same row of your table , replace them with the letters to their immediate right respectively ( wrapping around to the left side of the row if a letter in the original pair was on the right side of the row ) . if the letters appear on the same column of your table , replace them with the letters immediately below respectively ( wrapping around to the top side of the column if a letter in the original pair was on the bottom side of the column ) . if the letters are not on the same row or column , replace them with the letters on the same row respectively but at the other pair of corners of the rectangle defined by the original pair . the order is important – the first letter of the encrypted pair is the one that lies on the same row as the first letter of the plaintext pair . to decrypt , use the inverse ( opposite ) of the last 3 rules , and the first as-is ( dropping any extra '' x '' s or '' q '' s that do not make sense in the final message when finished ) . there are several minor variations of the original playfair cipher . . example . using '' playfair example '' as the key ( assuming that i and j are interchangeable ) , the table becomes ( omitted letters in red ) : p l a y f i r e x m b c d g h k n o q s t u v w z encrypting the message '' hide the gold in the tree stump '' ( note the null '' x '' used to separate the repeated '' e '' s ) : hi de th eg ol di nt he tr ex es tu mp ^ . cryptanalysis . like most classical ciphers , the playfair cipher can be easily cracked if there is enough text . obtaining the key is relatively straightforward if both plaintext and ciphertext are known . when only the ciphertext is known , brute force cryptanalysis of the cipher involves searching through the key space for matches between the frequency of occurrence of digrams ( pairs of letters ) and the known frequency of occurrence of digrams in the assumed language of the original message . cryptanalysis of playfair is similar to that of four-square and two-square ciphers , though the relative simplicity of the playfair system makes identifying candidate plaintext strings easier . most notably , a playfair digraph and its reverse ( e.g . ab and ba ) will decrypt to the same letter pattern in the plaintext ( e.g . re and er ) . in english , there are many words which contain these reversed digraphs such as receiver and departed . identifying nearby reversed digraphs in the ciphertext and matching the pattern to a list of known plaintext words containing the pattern is an easy way to generate possible plaintext strings with which to begin constructing the key . a different approach to tackling a playfair cipher is the shotgun hill climbing method . this starts with a random square of letters . then minor changes are introduced ( i.e . switching letters , rows , or reflecting the entire square ) to see if the candidate plaintext is more like standard plaintext than before the change ( perhaps by comparing the digrams to a known frequency chart ) . if the new square is deemed to be an improvement , then it is adopted and then further mutated to find an even better candidate . eventually , the plaintext or something very close is found to achieve a maximal score by whatever grading method is chosen . this is obviously beyond the range of typical human patience , but computers can adopt this algorithm to crack playfair ciphers with a relatively small amount of text . another aspect of playfair that separates it from four-square and two-square ciphers is the fact that it will never contain a double-letter digram , e.g . ee . if there are no double letter digrams in the ciphertext and the length of the message is long enough to make this statistically significant , it is very likely that the method of encryption is playfair . a good tutorial on reconstructing the key for a playfair cipher can be found in chapter 7 , '' solution to polygraphic substitution systems , '' of field manual 34-40-2 , produced by the united states army . another cryptanalysis of a playfair cipher can be found in chapter xxi of helen fouché gaines , cryptanalysis / a study of ciphers and their solutions . a detailed cryptanalysis of playfair is undertaken in chapter 28 of dorothy l . sayers ' mystery novel have his carcase . in this story , a playfair message is demonstrated to be cryptographically weak , as the detective is able to solve for the entire key making only a few guesses as to the formatting of the message ( in this case , that the message starts with the name of a city and then a date ) . sayers ' book includes a detailed description of the mechanics of playfair encryption , as well as a step-by-step account of manual cryptanalysis . the german army , air force and police used the double playfair cipher as a medium-grade cipher in wwii , based on the british playfair cipher they had broken early in wwi . they adapted it by introducing a second square from which the second letter of each bigram was selected , and dispensed with the keyword , placing the letters in random order . but with the german fondness for pro forma messages , they were broken at bletchley park . messages were preceded by a sequential number , and numbers were spelled out . as the german numbers 1 ( eins ) to twelve ( zwölf ) contain all but eight of the letters in the double playfair squares , pro forma traffic was relatively easy to break ( smith , page 74-75 ) . use in modern crosswords . advanced thematic cryptic crosswords like the listener crossword ( published in the saturday edition of the british newspaper the times ) occasionally incorporate playfair ciphers . listener crossword database normally between four and six answers have to be entered into the grid in code , and the playfair keyphrase is thematically significant to the final solution . the cipher lends itself well to crossword puzzles , because the plaintext is found by solving one set of clues , while the ciphertext is found by solving others . solvers can then construct the key table by pairing the digrams ( it is sometimes possible to guess the keyword , but never necessary ) . use of the playfair cipher is generally explained as part of the preamble to the crossword . this levels the playing field for those solvers who have not come across the cipher previously . but the way the cipher is used is always the same . the 25-letter alphabet used always contains q and has i and j coinciding . the key table is always filled row by row . in popular culture . the novel have his carcase by dorothy l . sayers gives a blow-by-blow account of the cracking of a playfair cipher . the world war 2 thriller the trojan horse by hammond innes conceals the formula for a new high-strength metal alloy using the playfair cipher . in the film national treasure : book of secrets , a treasure hunt clue is encoded as a playfair cipher . in the audio book rogue angel : god of thunder , a playfair cipher clue is used to send anja creed to venice . in the novel york : the map of stars ( part three of a trilogy for children ) by laura ruby , a clue to solving the morningstarr cipher is encrypted using the playfair cipher .