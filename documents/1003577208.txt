Filter design

typical design requirements . typical requirements which are considered in the design process are : the filter should have a specific frequency response the filter should have a specific phase shift or group delay the filter should have a specific impulse response the filter should be causal the filter should be stable the filter should be localized ( pulse or step inputs should result in finite time outputs ) the computational complexity of the filter should be low the filter should be implemented in particular hardware or software . the frequency function . an important parameter is the required frequency response . in particular , the steepness and complexity of the response curve is a deciding factor for the filter order and feasibility . a first-order recursive filter will only have a single frequency-dependent component . this means that the slope of the frequency response is limited to 6 db per octave . for many purposes , this is not sufficient . to achieve steeper slopes , higher-order filters are required . in relation to the desired frequency function , there may also be an accompanying weighting function , which describes , for each frequency , how important it is that the resulting frequency function approximates the desired one . the larger weight , the more important is a close approximation . typical examples of frequency function are : a low-pass filter is used to cut unwanted high-frequency signals . a high-pass filter passes high frequencies fairly well ; it is helpful as a filter to cut any unwanted low-frequency components . a band-pass filter passes a limited range of frequencies . a band-stop filter passes frequencies above and below a certain range . a very narrow band-stop filter is known as a notch filter . a differentiator has an amplitude response proportional to the frequency . a low-shelf filter passes all frequencies , but increases or reduces frequencies below the shelf frequency by specified amount . a high-shelf filter passes all frequencies , but increases or reduces frequencies above the shelf frequency by specified amount . a peak eq filter makes a peak or a dip in the frequency response , commonly used in equalization ( audio ) . phase and group delay . an all-pass filter passes through all frequencies unchanged , but changes the phase of the signal . filters of this type can be used to equalize the group delay of recursive filters . this filter is also used in phaser effects . a hilbert transformer is a specific all-pass filter that passes sinusoids with unchanged amplitude but shifts each sinusoid phase by ±90° . a fractional delay filter is an all-pass that has a specified and constant group or phase delay for all frequencies . the impulse response . there is a direct correspondence between the filter 's frequency function and its impulse response : the former is the fourier transform of the latter . that means that any requirement on the frequency function is a requirement on the impulse response , and vice versa . however , in certain applications it may be the filter 's impulse response that is explicit and the design process then aims at producing as close an approximation as possible to the requested impulse response given all other requirements . in some cases it may even be relevant to consider a frequency function and impulse response of the filter which are chosen independently from each other . for example , we may want both a specific frequency function of the filter and that the resulting filter have a small effective width in the signal domain as possible . the latter condition can be realized by considering a very narrow function as the wanted impulse response of the filter even though this function has no relation to the desired frequency function . the goal of the design process is then to realize a filter which tries to meet both these contradicting design goals as much as possible . causality . in order to be implementable , any time-dependent filter ( operating in real time ) must be causal : the filter response only depends on the current and past inputs . a standard approach is to leave this requirement until the final step . if the resulting filter is not causal , it can be made causal by introducing an appropriate time-shift ( or delay ) . if the filter is a part of a larger system ( which it normally is ) these types of delays have to be introduced with care since they affect the operation of the entire system . filters that do not operate in real time ( e.g . for image processing ) can be non-causal . this e.g . allows the design of zero delay recursive filters , where the group delay of a causal filter is canceled by its hermitian non-causal filter . stability . a stable filter assures that every limited input signal produces a limited filter response . a filter which does not meet this requirement may in some situations prove useless or even harmful . certain design approaches can guarantee stability , for example by using only feed-forward circuits such as an fir filter . on the other hand , filters based on feedback circuits have other advantages and may therefore be preferred , even if this class of filters includes unstable filters . in this case , the filters must be carefully designed in order to avoid instability . locality . in certain applications we have to deal with signals which contain components which can be described as local phenomena , for example pulses or steps , which have certain time duration . a consequence of applying a filter to a signal is , in intuitive terms , that the duration of the local phenomena is extended by the width of the filter . this implies that it is sometimes important to keep the width of the filter 's impulse response function as short as possible . according to the uncertainty relation of the fourier transform , the product of the width of the filter 's impulse response function and the width of its frequency function must exceed a certain constant . this means that any requirement on the filter 's locality also implies a bound on its frequency function 's width . consequently , it may not be possible to simultaneously meet requirements on the locality of the filter 's impulse response function as well as on its frequency function . this is a typical example of contradicting requirements . computational complexity . a general desire in any design is that the number of operations ( additions and multiplications ) needed to compute the filter response is as low as possible . in certain applications , this desire is a strict requirement , for example due to limited computational resources , limited power resources , or limited time . the last limitation is typical in real-time applications . there are several ways in which a filter can have different computational complexity . for example , the order of a filter is more or less proportional to the number of operations . this means that by choosing a low order filter , the computation time can be reduced . for discrete filters the computational complexity is more or less proportional to the number of filter coefficients . if the filter has many coefficients , for example in the case of multidimensional signals such as tomography data , it may be relevant to reduce the number of coefficients by removing those which are sufficiently close to zero . in multirate filters , the number of coefficients by taking advantage of its bandwidth limits , where the input signal is downsampled ( e.g . to its critical frequency ) , and upsampled after filtering . another issue related to computational complexity is separability , that is , if and how a filter can be written as a convolution of two or more simpler filters . in particular , this issue is of importance for multidimensional filters , e.g . , 2d filter which are used in image processing . in this case , a significant reduction in computational complexity can be obtained if the filter can be separated as the convolution of one 1d filter in the horizontal direction and one 1d filter in the vertical direction . a result of the filter design process may , e.g . , be to approximate some desired filter as a separable filter or as a sum of separable filters . other considerations . it must also be decided how the filter is going to be implemented : analog filter analog sampled filter digital filter mechanical filter . analog filters . the design of linear analog filters is for the most part covered in the linear filter section . digital filters . digital filters are classified into one of two basic forms , according to how they respond to a unit impulse : finite impulse response , or fir , filters express each output sample as a weighted sum of the last n input samples , where n is the order of the filter . fir filters are normally non-recursive , meaning they do not use feedback and as such are inherently stable . a moving average filter or cic filter are examples of fir filters that are normally recursive ( that use feedback ) . if the fir coefficients are symmetrical ( often the case ) , then such a filter is linear phase , so it delays signals of all frequencies equally which is important in many applications . it is also straightforward to avoid overflow in an fir filter . the main disadvantage is that they may require significantly more processing and memory resources than cleverly designed iir variants . fir filters are generally easier to design than iir filters - the parks-mcclellan filter design algorithm ( based on the remez algorithm ) is one suitable method for designing quite good filters semi-automatically . ( see methodology . ) infinite impulse response , or iir , filters are the digital counterpart to analog filters . such a filter contains internal state , and the output and the next internal state are determined by a linear combination of the previous inputs and outputs ( in other words , they use feedback , which fir filters normally do not ) . in theory , the impulse response of such a filter never dies out completely , hence the name iir , though in practice , this is not true given the finite resolution of computer arithmetic . iir filters normally require less computing resources than an fir filter of similar performance . however , due to the feedback , high order iir filters may have problems with instability , arithmetic overflow , and limit cycles , and require careful design to avoid such pitfalls . additionally , since the phase shift is inherently a non-linear function of frequency , the time delay through such a filter is frequency-dependent , which can be a problem in many situations . 2nd order iir filters are often called 'biquads ' and a common implementation of higher order filters is to cascade biquads . a useful reference for computing biquad coefficients is the rbj audio eq cookbook . sample rate . unless the sample rate is fixed by some outside constraint , selecting a suitable sample rate is an important design decision . a high rate will require more in terms of computational resources , but less in terms of anti-aliasing filters . interference and beating with other signals in the system may also be an issue . anti-aliasing . for any digital filter design , it is crucial to analyze and avoid aliasing effects . often , this is done by adding analog anti-aliasing filters at the input and output , thus avoiding any frequency component above the nyquist frequency . the complexity ( i.e . , steepness ) of such filters depends on the required signal to noise ratio and the ratio between the sampling rate and the highest frequency of the signal . theoretical basis . parts of the design problem relate to the fact that certain requirements are described in the frequency domain while others are expressed in the signal domain and that these may contradict . for example , it is not possible to obtain a filter which has both an arbitrary impulse response and arbitrary frequency function . other effects which refer to relations between the signal and frequency domain are the uncertainty principle between the signal and frequency domains the variance extension theorem the asymptotic behaviour of one domain versus discontinuities in the other . the uncertainty principle . as stated by the gabor limit , an uncertainty principle , the product of the width of the frequency function and the width of the impulse response can not be smaller than a specific constant . this implies that if a specific frequency function is requested , corresponding to a specific frequency width , the minimum width of the filter in the signal domain is set . vice versa , if the maximum width of the response is given , this determines the smallest possible width in the frequency . this is a typical example of contradictory requirements where the filter design process may try to find a useful compromise . the variance extension theorem . let \sigma^ norm has to be approximated by means of a suitable sum over discrete points in the frequency domain . in general , however , these points should be significantly more than the number of coefficients in the signal domain to obtain a useful approximation . simultaneous optimization in both domains . the previous method can be extended to include an additional error term related to a desired filter impulse response in the signal domain , with a corresponding weighting function . the ideal impulse response can be chosen independently of the ideal frequency function and is in practice used to limit the effective width and to remove ringing effects of the resulting filter in the signal domain . this is done by choosing a narrow ideal filter impulse response function , e.g . , an impulse , and a weighting function which grows fast with the distance from the origin , e.g . , the distance squared . the optimal filter can still be calculated by solving a simple least squares problem and the resulting filter is then a '' compromise '' which has a total optimal fit to the ideal functions in both domains . an important parameter is the relative strength of the two weighting functions which determines in which domain it is more important to have a good fit relative to the ideal function .